/*! For license information please see feedback-form.js.LICENSE.txt */
(self.webpackChunkcme_group_transform=self.webpackChunkcme_group_transform||[]).push([[6104,5076,8638],{3113:e=>{e.exports={component:"component","feedback-form":"feedback-form",feedbackForm:"feedback-form",icon:"icon","feedback-form-modal":"feedback-form-modal",feedbackFormModal:"feedback-form-modal","modal-header":"modal-header",modalHeader:"modal-header","modal-body":"modal-body",modalBody:"modal-body","modal-footer":"modal-footer",modalFooter:"modal-footer","btn-close":"btn-close",btnClose:"btn-close","modal-title":"modal-title",modalTitle:"modal-title","form-group":"form-group",formGroup:"form-group","email-container":"email-container",emailContainer:"email-container","form-control":"form-control",formControl:"form-control","message-container":"message-container",messageContainer:"message-container","message-length-error":"message-length-error",messageLengthError:"message-length-error","hidden-message-error":"hidden-message-error",hiddenMessageError:"hidden-message-error","smile-selector":"smile-selector",smileSelector:"smile-selector",faces:"faces",sad:"sad",happy:"happy",normal:"normal","email-faces-container":"email-faces-container",emailFacesContainer:"email-faces-container","grecaptcha-badge":"grecaptcha-badge",grecaptchaBadge:"grecaptcha-badge",message:"message","submit-message-succeeded":"submit-message-succeeded",submitMessageSucceeded:"submit-message-succeeded","submit-message-failed":"submit-message-failed",submitMessageFailed:"submit-message-failed"}},99640:(e,a,t)=>{"use strict";var s,o=t(74848),i=t(96540),r=t(69733),n=t(22075),c=t(24930),m=t(17535),l=t(53370),d=t(23239),h=t(27592),g=t(48210),u=t(8756),p=t(36590),f=t(46942),b=t.n(f),x=t(23896),y=t(24969),j=t(26088),k=t(75045),v=t(3113),F=t.n(v),A=function(e,a,t,s){var o,i=arguments.length,r=i<3?a:null===s?s=Object.getOwnPropertyDescriptor(a,t):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,a,t,s);else for(var n=e.length-1;n>=0;n--)(o=e[n])&&(r=(i<3?o(r):i>3?o(a,t,r):o(a,t))||r);return i>3&&r&&Object.defineProperty(a,t,r),r},C=function(e,a){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,a)},w=function(e,a,t,s){return new(t||(t=Promise))((function(o,i){function r(e){try{c(s.next(e))}catch(e){i(e)}}function n(e){try{c(s.throw(e))}catch(e){i(e)}}function c(e){var a;e.done?o(e.value):(a=e.value,a instanceof t?a:new t((function(e){e(a)}))).then(r,n)}c((s=s.apply(e,a||[])).next())}))};let S=s=class extends i.Component{constructor(e){super(e),this.toggle=()=>{this.setState((e=>({modal:!e.modal})))},this.handleInputChange=e=>{const{target:a}=e,{name:t,value:o}=a,{errors:i}=this.state,r=(0,k.i18n)("Please limit the message to 500 characters.");if("message"===t){const e=o.trim();i.textLength=e.length>s.maxLength?r:"",i.message&&e&&(i.message="")}"email"===t&&i.email&&o.trim()&&(i.email=""),this.setState({[t]:o,errors:i})},this.onSubmit=e=>w(this,void 0,void 0,(function*(){var a;e.preventDefault();const{message:t,email:o,face:i,loggedIn:r}=this.state,n={email:"",message:"",textLength:"",recaptcha:""},c=yield null===(a=this.recaptcha)||void 0===a?void 0:a.execute();if(c||(n.recaptcha="Recaptcha validation fail!"),t.trim()||(n.message="Text error detected"),o.trim()?s.emailRegEx.test(o)||(n.email="You need to insert a valid email"):n.email="Please add your email",this.setState({errors:n}),!(n.message||n.email||n.textLength||n.recaptcha)){const{location:e}=window,a=e.origin+e.pathname+e.search+e.hash,s={cmeFooterEmail:o.trim(),cmeFooterMessage:t.trim(),cmeFeedbackURL:a,cmeTriggerFooter:"",redirect:"false",screenWidth:window.screen.width,screenHeight:window.screen.height,flashVersion:"No Flash",FeedbackRating:i,"g-recaptcha-response":c},n=Object.keys(s).map((e=>encodeURIComponent(e)+"="+encodeURIComponent(s[e]))).join("&");this.setState({submitting:!0,submitted:!1,submitFailure:!1});(yield(0,j.postFeedback)(n))?(this.setState({message:"",face:"",email:r?o:"",submitted:!0,submitFailure:!1}),setTimeout((()=>{this.setState({submitted:!1})}),1e4)):this.setState({submitFailure:!0}),this.setState({submitting:!1})}return!1})),this.state={modal:!1,message:"",email:"",face:"",submitted:!1,submitFailure:!1,errors:{email:"",message:"",textLength:"",recaptcha:""},submitting:!1,loggedIn:!1},this.recaptcha=null,this.initRecaptcha()}initRecaptcha(){return w(this,void 0,void 0,(function*(){this.recaptchaText=(0,k.getRecaptchaText)(),this.recaptcha=yield(0,p.Hh)("6LcQNhAeAAAAACA68jQ-wJef1U-hMQjK3Lvh-yPr",{autoHideBadge:!0})}))}componentDidMount(){return w(this,void 0,void 0,(function*(){const{AEMAuth:e}=this.props,a=yield e.loginPromise;a&&this.setState({email:a.email,loggedIn:!0})}))}shouldComponentUpdate(e){const{openFeedbackForm:{timestamp:a}}=this.props,{openFeedbackForm:{timestamp:t}}=e;return a===t||(this.toggle(),!1)}render(){const{modal:e,message:a,email:t,face:s,errors:i,submitted:r,submitFailure:p,submitting:f}=this.state,{isCustom:y,modalTitle:j,buttonText:v,buttonStyles:A,iconStyle:C,customClass:w}=this.props;return(0,o.jsxs)("div",{children:[(0,o.jsx)(x.Button,{color:y?A:"primary",icon:y?C:"icon-chat",onClick:this.toggle,className:y?w:"",children:y?v:"Feedback"}),(0,o.jsxs)(n.A,{wrapClassName:"cme-styles",isOpen:e,toggle:this.toggle,className:F().feedbackFormModal,children:[(0,o.jsx)(c.A,{toggle:this.toggle,children:(0,k.i18n)(y?j:"Provide feedback or share an idea")}),(0,o.jsx)(m.A,{children:(0,o.jsxs)(l.A,{onSubmit:this.onSubmit,children:[(0,o.jsxs)(d.A,{className:F().messageContainer,children:[(0,o.jsx)(h.A,{for:"feedback-message",children:(0,k.i18n)("Your Message")}),(0,o.jsx)(x.TextArea,{name:"message",id:"feedback-message",error:""!==i.message||""!==i.textLength,rows:"6",onChange:this.handleInputChange,value:a}),i.textLength&&(0,o.jsx)("span",{className:F().messageLengthError,children:(0,k.i18n)("Please limit the message to 500 characters.")})]}),(0,o.jsxs)(d.A,{className:F().emailFacesContainer,children:[(0,o.jsxs)(d.A,{className:F().emailContainer,children:[(0,o.jsx)(h.A,{for:"email",children:(0,k.i18n)("Email")}),(0,o.jsx)(x.Input,{type:"email",name:"email",id:"email",error:""!==i.email,onChange:this.handleInputChange,value:t})]}),(0,o.jsxs)(d.A,{tag:"fieldset",className:F().smileSelector,children:[(0,o.jsx)(g.A,{type:"radio",name:"face",id:"sad",value:"Average",onChange:this.handleInputChange,checked:"Average"===s}),(0,o.jsx)(h.A,{title:"Average",className:"faces sad",for:"sad"}),(0,o.jsx)(g.A,{type:"radio",name:"face",id:"normal",value:"Good",onChange:this.handleInputChange,checked:"Good"===s}),(0,o.jsx)(h.A,{title:"Good",className:"faces normal",for:"normal"}),(0,o.jsx)(g.A,{type:"radio",name:"face",id:"happy",value:"Very Good",onChange:this.handleInputChange,checked:"Very Good"===s}),(0,o.jsx)(h.A,{title:"Very Good",className:"faces happy",for:"happy"})]})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)(x.Button,{color:"primary",type:"submit",disabled:f,children:"Submit"}),(0,o.jsx)("p",{className:"recaptcha-text",children:this.recaptchaText})]})]})}),(0,o.jsxs)(u.A,{children:[i.recaptcha&&(0,o.jsx)("h5",{className:b()(F().submitMessageFailed,F().message),children:(0,k.i18n)("Recaptcha Validation Fail.")}),r&&(0,o.jsx)("h5",{className:b()(F().submitMessageSucceeded,F().message),children:(0,k.i18n)("Thank you, your feedback has been submitted.")}),p&&(0,o.jsx)("h5",{className:b()(F().submitMessageFailed,F().message),dangerouslySetInnerHTML:{__html:(0,k.i18n)("We are sorry, there is a problem. Your feedback can&apos;t be submitted right now.")}})]})]})]})}};S.maxLength=500,S.emailRegEx=/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i,S=s=A([(0,r.connect)((({openFeedbackForm:e})=>({openFeedbackForm:e}))),C("design:paramtypes",[Object])],S),y.aem2react.load("feedback-form",(e=>(0,o.jsx)(S,Object.assign({},e))))},25352:()=>{},37746:()=>{},98196:()=>{},1671:()=>{},26959:()=>{},60195:()=>{}},e=>{e.O(0,[4598],(()=>{return a=99640,e(e.s=a);var a}));e.O()}]);
//# sourceMappingURL=feedback-form.js.map